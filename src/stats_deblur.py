import scipy.stats as stats
import numpy as np
import seaborn as sns
import pandas as pd
import matplotlib.pyplot as plt



# ********************************************* GFN *********************************************
if 1:
    navie_psnr_rgb= []
    linear_psnr_rgb= [38.4087, 36.5231, 32.3269, 31.9143, 30.5154, 29.2907, 38.223, 36.9431, 33.5841, 33.2553, 32.0867, 30.6439, 45.153, 42.0396, 36.1709, 35.754, 33.6019, 31.4463, 36.7721, 36.2585, 35.5897, 35.5649, 34.939, 34.904, 45.0811, 44.142, 39.6131, 38.6097, 34.8053, 34.1285, 63.3797, 60.1426, 46.1538, 43.8748, 37.0178, 34.2001, 33.3863, 32.3101, 30.5696, 30.4166, 29.6641, 29.1056, 45.4687, 42.7453, 35.5757, 35.2267, 33.403, 30.6494, 39.2417, 36.6467, 31.9755, 31.4773, 29.9306, 28.9483, 35.4478, 35.18, 34.1871, 34.0002, 32.5504, 31.271, 38.3349, 35.9295, 31.458, 30.9775, 29.6807, 28.8836, 34.5698, 33.8555, 31.484, 31.34, 30.0118, 28.9815, 37.0603, 35.921, 32.9163, 32.5106, 30.8925, 29.7373, 46.4813, 43.1923, 34.8596, 34.2034, 31.9209, 31.2431, 40.8731, 37.9464, 32.926, 32.6316, 30.9199, 29.7823, 60.8948, 56.5801, 41.6561, 40.1585, 36.5085, 33.9717, 49.2142, 47.673, 41.7535, 40.9141, 37.5229, 33.3333, 56.1177, 52.0514, 38.3512, 37.6711, 35.2021, 32.476, 35.4187, 34.1804, 30.7331, 30.3736, 29.1731, 28.5406, 54.1844, 54.155, 54.1543, 54.1663, 54.1325, 54.063, 53.1941, 53.1055, 53.1129, 53.1334, 52.787, 52.484, 39.5057, 39.4537, 39.3557, 39.3669, 39.4194, 39.4335]
    log_psnr_rg= []
    pu_psnr_rgb= [41.8147, 42.1967, 50.8586, 51.3561, 50.5233, 47.3983, 40.8158, 40.7483, 44.9999, 45.6974, 47.3916, 47.3529, 46.0079, 43.3324, 39.8741, 39.8041, 40.7252, 43.6995, 37.5901, 37.2305, 37.1386, 37.2927, 37.5746, 38.4381, 45.2046, 44.3275, 41.3015, 40.732, 39.2674, 40.5943, 63.409, 60.2526, 47.4564, 45.4197, 39.9361, 38.58, 35.904, 35.9943, 37.0301, 37.1037, 36.8766, 37.3094, 49.5447, 47.6276, 45.5275, 46.2358, 49.9114, 48.9081, 46.696, 46.0627, 46.4716, 46.6118, 46.5668, 45.62, 39.1252, 39.4226, 39.8166, 39.7921, 40.2446, 40.7652, 47.2593, 47.0118, 46.0963, 46.0288, 45.6188, 44.9517, 41.541, 41.0044, 38.3794, 38.0769, 38.1457, 39.4466, 39.7249, 40.0654, 39.9829, 39.9948, 40.1547, 40.7291, 49.6023, 47.4955, 44.0783, 44.0394, 44.8864, 46.6489, 47.714, 46.0335, 44.521, 44.5546, 44.6702, 44.9114, 61.6701, 57.8764, 48.1059, 47.7106, 46.8854, 47.8446, 50.8456, 49.6862, 46.037, 45.8891, 45.6882, 47.0563, 56.3972, 52.3574, 42.5782, 42.1826, 41.4423, 42.2109, 37.6703, 38.2027, 43.6257, 44.3215, 44.2978, 42.9342, 54.1844, 54.155, 54.1543, 54.1663, 54.1325, 54.0641, 53.7972, 53.6088, 53.1676, 53.2383, 53.6898, 54.6662, 40.2808, 40.2062, 39.9057, 39.8432, 39.532, 39.4123]
    pq_psnr_rgb= [41.2645, 41.6597, 52.0389, 53.386, 57.3322, 58.481, 40.3774, 40.1778, 44.5241, 45.3832, 48.2792, 50.1472, 45.9822, 43.1819, 39.2209, 39.1294, 39.9464, 43.0898, 37.2347, 36.9135, 36.7892, 36.9067, 37.2491, 38.3281, 45.108, 44.2534, 40.8036, 40.1325, 38.5948, 39.9513, 63.409, 60.2526, 47.3267, 45.2028, 39.3747, 37.8287, 35.8112, 35.985, 37.7436, 37.9978, 38.4126, 39.0316, 49.2742, 47.2458, 44.9799, 45.7734, 50.012, 49.2057, 46.3893, 45.7371, 46.1485, 46.4479, 48.1001, 49.685, 39.1183, 39.9067, 41.2937, 41.2458, 42.3934, 43.3617, 47.3245, 47.152, 46.6671, 46.8585, 47.9412, 49.0987, 39.5689, 39.6149, 42.4987, 42.7505, 44.3861, 45.1274, 39.5436, 40.0654, 40.3118, 40.3782, 41.0577, 42.4057, 49.0213, 47.027, 44.1365, 44.1958, 45.1789, 47.0573, 47.5206, 45.6853, 44.0774, 44.1494, 44.8375, 46.1804, 57.882, 55.1112, 47.3317, 46.9714, 45.9927, 46.8114, 50.8662, 49.4192, 45.6418, 45.1965, 44.4728, 45.9811, 56.3471, 52.3318, 41.9083, 41.487, 40.677, 41.426, 37.523, 38.0355, 43.7387, 44.6566, 45.8879, 45.3167, 54.1844, 54.155, 54.1543, 54.1663, 54.1325, 54.0641, 53.5199, 53.307, 53.0487, 53.0964, 53.0077, 53.4648, 40.2003, 40.1154, 39.7837, 39.7705, 39.7075, 39.6655]
    navie_psnr_y= []
    linear_psnr_y= [42.107, 39.8528, 35.3773, 34.7624, 33.1013, 32.347, 41.1767, 39.1906, 36.7356, 36.2951, 34.6332, 33.6365, 56.1981, 51.3748, 40.3016, 39.3077, 36.8458, 35.921, 59.7129, 59.14, 54.2181, 52.5254, 46.0755, 41.4514, 67.8648, 64.458, 48.5364, 47.1495, 42.5199, 39.1286, 86.2161, 82.6629, 60.1096, 56.0929, 43.4788, 37.6757, 38.1908, 37.5626, 33.6911, 33.3824, 32.2574, 31.4796, 48.8678, 46.0876, 40.1255, 39.6395, 36.7193, 34.1779, 42.8882, 40.0644, 35.0983, 34.5685, 32.7616, 31.515, 45.8755, 43.8353, 39.6712, 39.2139, 37.1347, 34.9773, 42.2236, 39.5054, 34.4474, 34.0273, 32.3653, 31.2491, 40.4643, 38.8339, 35.5868, 35.2357, 33.3361, 31.9961, 41.1379, 40.2634, 35.8265, 35.3907, 33.9665, 32.6984, 50.4067, 47.3252, 39.8399, 39.2336, 36.0541, 34.0851, 45.117, 41.7925, 35.9324, 35.4334, 33.5789, 32.5429, 80.6926, 67.5869, 47.2024, 45.8214, 40.9082, 37.5009, 59.0774, 55.7706, 45.1226, 44.4321, 41.395, 38.7698, 78.4303, 74.068, 53.3179, 50.181, 41.2751, 37.3732, 38.7982, 37.1185, 33.5558, 33.075, 31.5867, 30.8159, 62.9934, 62.9507, 62.9501, 62.9674, 62.9181, 62.8278, 76.1418, 76.0532, 76.0608, 76.069, 75.6732, 75.241, 41.4579, 41.3819, 41.2457, 41.2569, 41.2777, 41.283]
    log_psnr_y= []
    pu_psnr_y= [43.6076, 42.4812, 52.2639, 53.7049, 55.4396, 48.5156, 43.1466, 42.133, 46.5471, 47.4852, 50.1241, 49.593, 56.8466, 52.4915, 42.8219, 41.9731, 40.9414, 43.8908, 60.5355, 60.1617, 56.048, 54.3933, 47.9729, 43.9016, 68.1086, 65.4698, 50.8183, 49.667, 46.2154, 43.5223, 86.2484, 82.8903, 62.3763, 58.0681, 45.014, 40.0529, 40.507, 41.5611, 41.4434, 41.1905, 40.1664, 39.8066, 50.1029, 48.1908, 45.6769, 46.4806, 51.1545, 50.4045, 50.016, 49.2533, 48.6601, 48.7022, 47.8278, 46.0652, 50.9057, 49.3757, 47.6127, 47.4776, 46.6797, 45.889, 50.6372, 51.3499, 48.7215, 48.2946, 47.0003, 45.5467, 47.6768, 47.1248, 45.708, 45.5473, 45.1336, 44.3874, 43.3668, 44.4195, 44.547, 44.1812, 42.9689, 42.6691, 52.7831, 50.4816, 45.755, 45.6817, 46.6516, 48.9102, 49.5921, 47.4899, 45.8159, 45.818, 45.6319, 45.6324, 83.6676, 71.1436, 51.1405, 50.1075, 48.1779, 48.6434, 60.3046, 57.7174, 48.6419, 48.4587, 47.5532, 48.4213, 79.0665, 74.4281, 55.8143, 52.6151, 44.3125, 43.0234, 40.5329, 40.1738, 45.0552, 46.019, 46.1216, 43.962, 62.9934, 62.9507, 62.9501, 62.9674, 62.9181, 62.8344, 76.7449, 76.5565, 76.117, 76.1813, 76.6562, 77.6369, 41.8751, 41.7822, 41.5575, 41.5222, 41.3452, 41.2491]
    pq_psnr_y= [43.0458, 41.9106, 52.3308, 53.879, 59.3714, 61.6399, 42.6855, 41.4645, 45.8368, 46.8902, 50.3974, 52.1027, 57.3385, 52.6702, 42.1269, 41.2536, 40.0986, 43.1115, 60.1802, 59.8463, 55.9527, 54.2636, 47.6814, 43.3823, 68.0146, 65.4192, 50.1699, 48.9776, 45.3333, 42.7334, 86.2484, 82.8903, 62.6716, 58.2621, 44.5841, 39.305, 40.3292, 41.4999, 41.2341, 41.1368, 41.0022, 41.3193, 49.7451, 47.7245, 45.0374, 45.8957, 50.8894, 50.5023, 49.3527, 48.4452, 47.9029, 48.107, 49.4454, 50.9266, 52.1067, 50.6231, 47.689, 47.4998, 46.8698, 46.0396, 50.3828, 51.1333, 49.2502, 49.2679, 50.2731, 51.1895, 46.8114, 46.3218, 48.157, 48.5196, 49.7857, 49.2048, 43.3534, 44.5384, 44.7437, 44.504, 43.8938, 44.3921, 52.3471, 49.9222, 45.7555, 45.7424, 46.6891, 48.837, 49.5608, 47.2148, 45.1872, 45.2411, 45.6635, 46.9993, 74.5818, 70.6996, 50.5183, 49.4736, 47.3179, 47.5746, 61.1827, 57.657, 48.3058, 47.6624, 46.1779, 47.222, 79.0191, 74.4032, 55.314, 52.0384, 43.5557, 42.2132, 40.3215, 39.8892, 44.8421, 45.9421, 47.4388, 46.378, 62.9934, 62.9507, 62.9501, 62.9674, 62.9181, 62.8344, 76.4676, 76.2547, 75.9902, 76.0242, 75.9154, 76.3899, 41.8041, 41.7337, 41.6013, 41.5938, 41.5356, 41.4753]
    navie_cvvdp= []
    linear_cvvdp= [7.9869, 7.4887, 8.0563, 8.1917, 8.5928, 8.6743, 8.0933, 7.6879, 7.0205, 7.0213, 7.3822, 7.8904, 9.4305, 9.1459, 7.8974, 7.675, 6.892, 6.7903, 9.7335, 9.7173, 9.341, 9.2122, 8.6306, 8.004, 9.8674, 9.7236, 8.8373, 8.6984, 8.0376, 7.4541, 9.9872, 9.9797, 9.5279, 9.3284, 8.1658, 7.1427, 7.8994, 7.912, 7.6118, 7.5297, 7.2872, 7.1181, 8.938, 8.6437, 7.6353, 7.6217, 7.8682, 8.252, 8.703, 8.5128, 7.8132, 7.757, 7.6282, 7.5996, 9.0057, 8.8166, 8.3768, 8.3109, 8.0462, 7.855, 8.9454, 8.7677, 8.2039, 8.1603, 8.1377, 8.1543, 8.4671, 8.2524, 7.6275, 7.5655, 7.4208, 7.4874, 8.336, 8.3882, 8.1959, 8.0983, 7.7117, 7.2486, 9.0878, 8.8357, 7.8134, 7.7046, 7.4946, 7.4132, 8.6088, 8.2551, 7.5994, 7.5544, 7.4174, 7.4291, 9.9408, 9.7316, 8.7512, 8.6038, 8.1452, 7.8222, 9.5591, 9.443, 8.6626, 8.5909, 8.1676, 7.8343, 9.959, 9.9422, 9.2153, 8.9645, 7.8597, 7.1825, 7.888, 7.5651, 7.3539, 7.4386, 7.7718, 7.8988, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
    log_cvvdp= []
    pu_cvvdp= [8.3617, 8.1714, 8.9161, 9.0114, 8.8398, 8.5193, 8.3503, 8.1866, 8.4895, 8.5463, 8.6861, 8.295, 9.4403, 9.1885, 8.2807, 8.1447, 7.8043, 8.1502, 9.7242, 9.7149, 9.4153, 9.2972, 8.7874, 8.3254, 9.8706, 9.7636, 9.0422, 8.9533, 8.6002, 8.2157, 9.987, 9.9799, 9.6117, 9.4331, 8.4057, 7.737, 8.199, 8.2022, 8.0818, 8.055, 8.0599, 8.1262, 9.04, 8.8896, 8.4869, 8.5668, 8.9446, 8.9221, 9.1009, 9.026, 8.9752, 8.9772, 8.8088, 8.6714, 9.0574, 8.946, 8.8821, 8.8801, 8.8269, 8.775, 9.3027, 9.335, 9.0003, 8.9866, 8.9416, 8.9065, 8.7887, 8.7453, 8.8036, 8.8023, 8.6874, 8.4138, 8.5681, 8.6086, 8.5797, 8.5501, 8.5232, 8.6082, 9.2017, 9.0356, 8.5553, 8.5524, 8.6843, 8.8913, 8.9721, 8.8084, 8.6535, 8.6589, 8.6311, 8.5336, 9.9541, 9.8117, 9.0585, 8.9637, 8.8413, 8.9116, 9.5629, 9.4813, 8.9161, 8.9221, 8.8804, 8.9559, 9.9648, 9.9423, 9.3413, 9.1348, 8.3763, 8.2185, 8.208, 8.0355, 8.4286, 8.5068, 8.6087, 8.5391, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
    pq_cvvdp= [8.2137, 7.9741, 8.9978, 9.0931, 9.4763, 9.6933, 8.2502, 8.021, 8.3358, 8.4363, 8.7787, 9.0464, 9.4489, 9.1905, 8.1358, 7.9797, 7.5666, 7.9622, 9.6711, 9.6615, 9.4061, 9.2832, 8.735, 8.2093, 9.86, 9.7579, 8.9719, 8.8707, 8.4412, 8.0223, 9.987, 9.9799, 9.624, 9.441, 8.3092, 7.5162, 8.0425, 8.1262, 7.9463, 7.933, 7.9506, 8.0379, 8.9954, 8.8203, 8.3089, 8.4007, 8.9052, 9.0314, 8.9823, 8.8753, 8.8033, 8.8276, 8.9784, 9.0687, 9.1607, 9.0586, 8.8105, 8.7931, 8.734, 8.6523, 9.2473, 9.2684, 8.9066, 8.902, 8.9921, 9.0829, 8.7887, 8.7097, 8.7859, 8.8079, 8.8556, 8.8037, 8.4601, 8.5664, 8.527, 8.4935, 8.4305, 8.5121, 9.1611, 8.9758, 8.5029, 8.4989, 8.6524, 8.8794, 8.936, 8.734, 8.5208, 8.5428, 8.604, 8.7086, 9.8039, 9.8058, 8.9755, 8.8706, 8.7067, 8.7564, 9.5832, 9.4626, 8.8268, 8.7745, 8.6547, 8.7339, 9.9611, 9.9414, 9.3029, 9.0722, 8.2136, 8.0093, 8.0564, 7.8819, 8.337, 8.4617, 8.6654, 8.681, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]

    # print(len(linear_psnr_rgb), len(pu_psnr_rgb), len(pq_psnr_rgb  ))

    # Perform t-test
    t_statistic, p_value = stats.ttest_ind(linear_psnr_rgb, pu_psnr_rgb)
    print('t statistic:', t_statistic)
    print('p value:', p_value)

    linear_psnr_rgb = np.array(linear_psnr_rgb)
    pu_psnr_rgb = np.array(pu_psnr_rgb)
    pq_psnr_rgb = np.array(pq_psnr_rgb)
    print(np.mean(linear_psnr_rgb), np.mean(pu_psnr_rgb), np.mean(pq_psnr_rgb))
    psnr_rgb_df = pd.DataFrame({'linear_psnr_rgb': linear_psnr_rgb, 'pu_psnr_rgb': pu_psnr_rgb, 'pq_psnr_rgb': pq_psnr_rgb})


    linear_psnr_y = np.array(linear_psnr_y)
    pu_psnr_y = np.array(pu_psnr_y)
    pq_psnr_y = np.array(pq_psnr_y)
    print(np.mean(linear_psnr_y), np.mean(pu_psnr_y), np.mean(pq_psnr_y))
    psnr_y_df = pd.DataFrame({'linear_psnr_y': linear_psnr_y, 'pu_psnr_y': pu_psnr_y, 'pq_psnr_y': pq_psnr_y})

    linear_cvvdp = np.array(linear_cvvdp)
    pu_cvvdp = np.array(pu_cvvdp)
    pq_cvvdp = np.array(pq_cvvdp)
    print(np.mean(linear_cvvdp), np.mean(pu_cvvdp), np.mean(pq_cvvdp))
    cvvdp_df = pd.DataFrame({'linear_cvvdp': linear_cvvdp, 'pu_cvvdp': pu_cvvdp, 'pq_cvvdp': pq_cvvdp})


    sns.violinplot(data=psnr_rgb_df)
    plt.ylabel('wdsr_psnr_rgb')
    plt.savefig('wdsr_psnr_rgb.png')
    plt.clf()

    sns.violinplot(data=psnr_y_df)
    plt.ylabel('wdsr_psnr_y')
    plt.savefig('wdsr_psnr_y.png')
    plt.clf()

    sns.violinplot(data=cvvdp_df)
    plt.ylabel('wdsr_cvvdp')
    plt.savefig('wdsr_cvvdp.png')
    plt.clf()

# ********************************************* MIRNET *********************************************
if 1:
    navie_psnr_rgb= []
    linear_psnr_rgb= [39.552, 39.9871, 51.2764, 53.0371, 58.6474, 60.8455, 37.96, 37.7756, 42.8331, 43.9283, 47.7392, 50.2802, 44.413, 42.0139, 39.203, 39.2227, 40.5337, 44.2565, 36.3404, 35.7821, 35.6238, 35.8088, 36.4865, 37.8498, 44.9715, 44.0105, 40.6232, 40.0431, 38.7218, 40.2704, 62.8294, 59.6014, 46.8376, 44.9266, 39.5964, 38.3, 31.8321, 33.0282, 33.6865, 33.9457, 34.9731, 36.6088, 46.9219, 44.5005, 43.7205, 44.7493, 50.1456, 50.6327, 38.8591, 41.6435, 44.9448, 45.6251, 48.7636, 51.3531, 33.2673, 34.0509, 35.6079, 36.064, 37.2976, 38.8021, 37.0759, 40.9353, 45.278, 45.6427, 47.5499, 49.7617, 36.0775, 37.0921, 39.3337, 39.6635, 40.5496, 40.645, 37.5182, 37.8095, 38.6519, 38.861, 39.6482, 41.2203, 46.1252, 44.5439, 43.1021, 43.4626, 45.8139, 48.6428, 41.6028, 41.0993, 42.9094, 43.4014, 45.3833, 47.5717, 59.3977, 55.727, 45.9278, 45.6617, 45.7911, 47.6128, 48.6841, 47.4913, 45.6203, 45.5094, 45.5823, 47.5785, 56.0839, 51.9738, 41.975, 41.6137, 41.1221, 42.2304, 34.7867, 36.2989, 42.3353, 43.3394, 45.4157, 45.5987, 54.1844, 54.155, 54.1543, 54.1663, 54.1325, 54.0641, 53.1806, 53.0972, 53.1939, 53.2497, 53.3919, 53.9936, 39.48, 39.4619, 39.4636, 39.5128, 39.5348, 39.6312]
    log_psnr_rg= []
    pu_psnr_rgb= [41.6488, 41.9503, 52.0007, 53.372, 57.3566, 58.5436, 40.9788, 40.8043, 45.4761, 46.3938, 49.5567, 51.5884, 46.3862, 43.7574, 40.1107, 40.0384, 41.0323, 44.4193, 37.7464, 37.426, 37.4179, 37.5904, 37.8833, 38.6406, 45.2379, 44.3766, 41.4426, 40.8889, 39.4472, 40.7981, 63.409, 60.2526, 47.7643, 45.7494, 40.2955, 38.9635, 35.9753, 36.3848, 38.2237, 38.4296, 38.5432, 39.2141, 49.8278, 48.0805, 45.6764, 46.427, 50.7014, 50.7704, 47.4584, 46.8493, 47.6048, 48.0116, 49.7934, 51.0902, 40.07, 40.3922, 41.0574, 41.1874, 41.4201, 41.3114, 47.5453, 47.2066, 47.4338, 47.688, 48.8679, 50.1807, 42.9086, 42.7623, 44.2298, 44.7094, 45.1115, 43.7808, 39.9716, 40.6575, 41.3391, 41.4076, 41.9777, 42.9324, 50.1323, 48.1908, 45.772, 45.9169, 47.0689, 49.1303, 48.8575, 46.9755, 45.3344, 45.4258, 46.2129, 47.7858, 61.7352, 57.975, 48.5411, 48.1629, 47.462, 48.5972, 51.3474, 50.3379, 46.877, 46.6718, 46.5304, 48.2016, 56.3941, 52.4296, 42.8992, 42.4967, 41.7011, 42.486, 37.7799, 38.2981, 44.1528, 45.1388, 46.7079, 46.1418, 54.1844, 54.155, 54.1543, 54.1663, 54.1325, 54.0641, 54.1933, 53.2326, 52.964, 53.0657, 53.5245, 54.6673, 40.4092, 40.2844, 39.9227, 39.9193, 39.8746, 39.8429]
    pq_psnr_rgb= [42.2959, 42.7532, 53.5455, 55.0656, 59.8263, 61.0928, 41.6713, 41.6462, 46.5557, 47.5432, 50.904, 52.8465, 46.4551, 43.981, 40.7862, 40.7365, 41.7711, 45.204, 37.825, 37.5708, 37.7005, 37.895, 38.4972, 39.7319, 45.3082, 44.4648, 41.7102, 41.2173, 40.0015, 41.5326, 63.409, 60.2526, 47.9711, 46.0094, 40.7621, 39.6525, 35.9924, 36.66, 39.1615, 39.4797, 40.0777, 41.0168, 50.2121, 48.4667, 46.406, 47.225, 51.8102, 51.7528, 49.0661, 48.7051, 49.308, 49.5905, 51.2866, 52.7396, 40.3859, 41.2911, 42.9169, 43.0826, 44.4124, 45.7689, 48.255, 48.2323, 48.3342, 48.6504, 50.1266, 51.2099, 42.8695, 42.9561, 44.5264, 44.9726, 46.6167, 47.3297, 40.1916, 40.9518, 42.2088, 42.421, 43.8307, 45.5326, 50.2362, 48.4813, 46.7616, 46.9122, 48.3592, 50.6491, 50.3062, 48.3806, 46.5018, 46.6072, 47.2856, 48.6594, 61.1561, 58.01, 49.4509, 49.1668, 48.5825, 49.8543, 51.2852, 50.4846, 48.2, 47.923, 47.9263, 49.4415, 56.3842, 52.4437, 43.2898, 42.9422, 42.3516, 43.2771, 38.0592, 38.6896, 44.9379, 45.8443, 46.763, 45.9427, 54.1844, 54.155, 54.1543, 54.1663, 54.1325, 54.0641, 54.6213, 54.2991, 53.7553, 53.7666, 53.8017, 54.737, 40.3747, 40.353, 39.9834, 39.9886, 39.9295, 39.9097]
    navie_psnr_y= []
    linear_psnr_y= [41.6474, 40.3808, 51.3671, 53.1923, 60.1438, 63.3656, 40.6892, 39.3849, 44.1137, 45.4353, 50.5259, 53.54, 54.5474, 51.1025, 42.1693, 41.394, 40.6598, 44.1996, 59.2161, 58.2872, 54.1348, 52.8524, 47.6884, 43.8678, 67.8149, 64.253, 49.0345, 47.9826, 45.2106, 43.1512, 85.6339, 82.16, 61.5941, 57.5252, 44.8875, 39.8236, 36.5602, 38.1976, 39.4576, 39.4955, 39.9797, 41.0892, 47.7748, 45.3223, 43.7839, 44.8512, 50.8111, 51.6973, 41.1336, 45.4935, 48.1382, 48.5603, 50.5753, 52.806, 37.5792, 41.1113, 44.3536, 44.6479, 45.732, 46.6387, 37.272, 42.1259, 48.442, 48.8129, 50.7423, 52.3766, 40.5549, 41.6362, 45.5427, 46.0508, 47.9905, 47.7735, 41.2979, 42.1883, 43.5894, 43.5323, 43.4739, 44.3805, 49.9379, 47.9464, 44.6907, 45.0702, 47.7439, 50.9784, 45.0099, 42.9148, 44.0886, 44.5648, 46.2794, 48.3826, 75.0587, 64.8676, 48.8286, 47.9165, 46.9944, 48.2429, 55.8133, 53.4863, 48.4953, 48.2623, 47.7755, 49.2105, 78.5086, 73.8322, 55.2378, 52.1495, 44.0535, 42.9876, 38.5534, 38.6602, 43.861, 45.1059, 47.693, 47.1109, 62.9934, 62.9507, 62.9501, 62.9674, 62.9181, 62.8344, 76.1283, 76.0449, 76.1431, 76.1897, 76.3176, 76.9394, 41.3875, 41.3456, 41.3268, 41.3637, 41.3535, 41.3959]
    log_psnr_y= []
    pu_psnr_y= [43.4159, 42.1879, 51.894, 53.2595, 57.3962, 58.5334, 43.2821, 42.0766, 46.6706, 47.7461, 51.604, 53.5178, 57.9073, 53.4761, 43.1208, 42.2524, 41.1617, 44.3504, 60.6918, 60.3587, 56.4252, 54.6738, 47.8821, 43.9119, 68.1455, 65.6758, 51.367, 50.1111, 46.4566, 43.7792, 86.2484, 82.8903, 63.0304, 58.5152, 45.3602, 40.4332, 40.5629, 41.7516, 42.4165, 42.2911, 42.0345, 42.3074, 50.3338, 48.621, 45.6914, 46.4932, 51.36, 51.5787, 50.2041, 49.5131, 49.6183, 49.8298, 50.6892, 51.3961, 53.1879, 51.9732, 49.7991, 49.5924, 48.7253, 48.0865, 50.5549, 50.8559, 49.7691, 49.8904, 50.7782, 51.7157, 48.98, 48.4094, 49.6034, 50.0438, 50.9001, 49.0985, 43.4397, 44.6833, 45.9679, 45.6708, 44.7621, 45.0741, 53.4713, 51.2217, 47.3145, 47.3842, 48.4065, 50.613, 50.6708, 48.2844, 46.478, 46.5461, 46.9505, 48.3973, 83.817, 70.5064, 51.5373, 50.4649, 48.6175, 49.2051, 62.353, 59.1933, 49.3829, 49.1201, 48.3882, 49.532, 79.0637, 74.5223, 56.1864, 52.9896, 44.5858, 43.2558, 40.6436, 40.2432, 45.2239, 46.3895, 48.2233, 47.1981, 62.9934, 62.9507, 62.9501, 62.9674, 62.9181, 62.8344, 77.141, 76.1803, 75.9074, 76.0076, 76.5038, 77.7237, 42.0594, 41.9087, 41.6021, 41.6028, 41.5701, 41.5587]
    pq_psnr_y= [44.0763, 42.988, 53.6801, 55.2769, 61.0691, 63.2784, 43.8695, 42.8683, 47.7426, 48.9296, 53.2465, 55.504, 57.9004, 53.5948, 43.8407, 42.9807, 41.8708, 45.103, 60.7705, 60.5024, 56.6352, 55.0546, 48.8716, 44.8786, 68.2151, 65.667, 52.08, 50.9447, 47.4775, 44.5849, 86.2484, 82.8903, 63.4715, 59.1898, 45.9893, 41.1879, 40.7959, 42.1446, 43.365, 43.2687, 42.9458, 43.5687, 50.7101, 48.9991, 46.5048, 47.3821, 52.7787, 52.893, 52.088, 51.5926, 51.1034, 51.2589, 52.6315, 54.1777, 54.6622, 53.3304, 50.6518, 50.5342, 49.7795, 49.0342, 51.5181, 52.5063, 51.1381, 51.3728, 52.9325, 53.6396, 49.8324, 49.6555, 50.7517, 51.1923, 52.1601, 50.7573, 43.7076, 45.2048, 47.3431, 47.2736, 47.1918, 48.0405, 53.6152, 51.3354, 48.3536, 48.4545, 49.8558, 52.3694, 52.1669, 49.9088, 47.8329, 47.9037, 48.2058, 49.5082, 83.3461, 72.6923, 52.5809, 51.6062, 49.9123, 50.6825, 62.656, 59.721, 51.3109, 50.8679, 49.9283, 50.8356, 79.0546, 74.5419, 56.785, 53.6056, 45.2909, 44.1489, 40.8861, 40.6175, 46.2378, 47.3818, 48.567, 47.257, 62.9934, 62.9507, 62.9501, 62.9674, 62.9181, 62.8344, 77.569, 77.2469, 76.7035, 76.7041, 76.7551, 77.777, 42.0632, 42.0676, 41.8192, 41.83, 41.817, 41.7883]
    navie_cvvdp= []
    linear_cvvdp= [7.7331, 7.2722, 8.5916, 8.7871, 9.4538, 9.7921, 7.8986, 7.449, 7.6587, 7.8252, 8.5747, 9.159, 9.344, 9.0996, 8.1094, 7.9746, 7.7004, 8.2167, 9.6242, 9.5718, 9.2766, 9.1712, 8.7292, 8.2944, 9.8522, 9.6864, 8.804, 8.7035, 8.3677, 8.1, 9.9863, 9.975, 9.5655, 9.3816, 8.3488, 7.6421, 7.6297, 7.68, 7.7207, 7.7411, 7.9431, 8.2212, 8.7705, 8.4689, 7.8167, 7.9599, 8.7074, 9.1465, 8.4662, 8.5123, 8.811, 8.8747, 9.1149, 9.3048, 8.3659, 8.523, 8.4991, 8.518, 8.6188, 8.7769, 8.7298, 8.8186, 8.728, 8.7545, 8.9958, 9.2232, 8.023, 8.0346, 8.3542, 8.4039, 8.5952, 8.618, 8.1551, 8.2322, 8.4478, 8.4418, 8.4889, 8.6731, 8.9818, 8.745, 8.1982, 8.2508, 8.6977, 9.1502, 8.3422, 8.0632, 8.1741, 8.2826, 8.6373, 8.9174, 9.8262, 9.6422, 8.6701, 8.5567, 8.5696, 8.808, 9.4234, 9.2943, 8.8589, 8.8514, 8.8622, 9.0251, 9.9574, 9.9275, 9.286, 9.0709, 8.2916, 8.1923, 7.6987, 7.4796, 7.9426, 8.1225, 8.6862, 8.7992, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
    log_cvvdp= []
    pu_cvvdp= [8.2877, 8.0411, 9.0161, 9.1357, 9.4906, 9.7362, 8.3658, 8.1895, 8.5414, 8.6542, 9.0778, 9.3423, 9.4769, 9.2481, 8.3649, 8.2351, 7.8963, 8.3134, 9.7513, 9.7468, 9.4437, 9.3219, 8.7974, 8.3832, 9.8763, 9.7734, 9.1107, 9.0233, 8.6813, 8.3131, 9.987, 9.9799, 9.6469, 9.4591, 8.4832, 7.8823, 8.0875, 8.1887, 8.2854, 8.2806, 8.3179, 8.4427, 9.0569, 8.9284, 8.4602, 8.5416, 9.0759, 9.2868, 9.1285, 9.0898, 9.1217, 9.1456, 9.2251, 9.1936, 9.2643, 9.2029, 9.0972, 9.0889, 9.0179, 8.9935, 9.3124, 9.3218, 9.0823, 9.09, 9.1529, 9.2613, 8.9575, 8.9136, 9.0097, 9.0466, 9.0535, 8.8476, 8.4648, 8.5945, 8.7883, 8.7585, 8.7144, 8.7926, 9.2505, 9.1138, 8.7989, 8.8047, 8.9701, 9.2486, 9.0616, 8.8905, 8.7238, 8.7506, 8.847, 8.9981, 9.9589, 9.7872, 9.1059, 9.0032, 8.9088, 9.0083, 9.6333, 9.5512, 8.99, 9.0049, 9.0188, 9.139, 9.9648, 9.9449, 9.3793, 9.1847, 8.4634, 8.3362, 8.1387, 8.0028, 8.453, 8.5782, 8.8831, 8.8685, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
    pq_cvvdp= [8.4997, 8.3821, 9.2679, 9.3503, 9.641, 9.8142, 8.4795, 8.367, 8.7665, 8.8667, 9.216, 9.415, 9.4779, 9.2551, 8.4727, 8.3647, 8.0696, 8.4608, 9.7636, 9.7593, 9.4585, 9.3512, 8.9089, 8.5288, 9.8791, 9.7697, 9.1788, 9.1094, 8.8241, 8.4752, 9.987, 9.9799, 9.6681, 9.5066, 8.581, 8.0465, 8.2927, 8.378, 8.4028, 8.3936, 8.4105, 8.5463, 9.0979, 8.9841, 8.7026, 8.788, 9.2686, 9.3833, 9.3318, 9.2884, 9.2178, 9.2186, 9.3488, 9.4419, 9.4028, 9.3129, 9.1432, 9.1388, 9.0792, 9.0567, 9.428, 9.4606, 9.2067, 9.2229, 9.3367, 9.3864, 9.0348, 9.0182, 9.0931, 9.1209, 9.1491, 9.0382, 8.6604, 8.7829, 8.9444, 8.9356, 8.9465, 9.026, 9.2646, 9.1235, 8.9517, 8.9668, 9.1263, 9.3423, 9.2216, 9.0802, 8.9242, 8.9408, 8.9912, 9.0722, 9.9506, 9.855, 9.2075, 9.1291, 9.0692, 9.1751, 9.6408, 9.5726, 9.1497, 9.1438, 9.1644, 9.2274, 9.9648, 9.945, 9.4224, 9.2412, 8.5943, 8.528, 8.3386, 8.2297, 8.7512, 8.8466, 8.9402, 8.8698, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]


    # print(len(navie_psnr_rgb), len(linear_psnr_rgb), len(pu_psnr_rgb), len(pq_psnr_rgb  ))

    # Perform t-test
    t_statistic, p_value = stats.ttest_ind(linear_psnr_rgb, pu_psnr_rgb)
    print('t statistic:', t_statistic)
    print('p value:', p_value)

    linear_psnr_rgb = np.array(linear_psnr_rgb)
    pu_psnr_rgb = np.array(pu_psnr_rgb)
    pq_psnr_rgb = np.array(pq_psnr_rgb)
    print(np.mean(linear_psnr_rgb), np.mean(pu_psnr_rgb), np.mean(pq_psnr_rgb))
    psnr_rgb_df = pd.DataFrame({'linear_psnr_rgb': linear_psnr_rgb, 'pu_psnr_rgb': pu_psnr_rgb, 'pq_psnr_rgb': pq_psnr_rgb})


    linear_psnr_y = np.array(linear_psnr_y)
    pu_psnr_y = np.array(pu_psnr_y)
    pq_psnr_y = np.array(pq_psnr_y)
    print(np.mean(linear_psnr_y), np.mean(pu_psnr_y), np.mean(pq_psnr_y))
    psnr_y_df = pd.DataFrame({'linear_psnr_y': linear_psnr_y, 'pu_psnr_y': pu_psnr_y, 'pq_psnr_y': pq_psnr_y})


    linear_cvvdp = np.array(linear_cvvdp)
    pu_cvvdp = np.array(pu_cvvdp)
    pq_cvvdp = np.array(pq_cvvdp)
    print(np.mean(linear_cvvdp), np.mean(pu_cvvdp), np.mean(pq_cvvdp))
    cvvdp_df = pd.DataFrame({'linear_cvvdp': linear_cvvdp, 'pu_cvvdp': pu_cvvdp, 'pq_cvvdp': pq_cvvdp})


    sns.violinplot(data=psnr_rgb_df)
    plt.ylabel('wdsr_psnr_rgb')
    plt.savefig('wdsr_psnr_rgb.png')
    plt.clf()

    sns.violinplot(data=psnr_y_df)
    plt.ylabel('wdsr_psnr_y')
    plt.savefig('wdsr_psnr_y.png')
    plt.clf()

    sns.violinplot(data=cvvdp_df)
    plt.ylabel('wdsr_cvvdp')
    plt.savefig('wdsr_cvvdp.png')
    plt.clf()








"""
------------------- deblur -------------------
GFN
t statistic: -7.762280717987991
p value: 1.876150588990335e-13
38.05785606060606 44.807574242424245 45.128313636363636
45.018845454545456 51.15216590909091 51.32124924242424
7.14031893939394 7.632135606060606 7.604444696969698

MirNet-v2
t statistic: -2.5950103899896786
p value: 0.009991888211092039
43.905528030303024 45.89834318181818 46.698073484848486
50.154637878787874 52.135034090909095 53.08088863636363
7.467518181818183 7.752447727272728 7.8570113636363645
"""
