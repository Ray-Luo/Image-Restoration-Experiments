_target_: src.models.realesrgan_module.RealESRGANModule

loss: ${loss}

optimizer:
  _target_: torch.optim.Adam
  _partial_: true
  lr: 1e-3

scheduler:
  _target_: torch.optim.lr_scheduler.MultiStepLR
  _partial_: true
  milestones: [20, 25]
  gamma: 0.5

net:
  _target_: src.models.components.realesrgan.RealESRGANNet
  scale: 4
  num_input_channels: 3
  num_output_channels: 3

  loss:
    _target_: src.loss.realesrgan_loss.REALESRGANLosses

    pixel_opt:
      loss_weight: 1.0
      reduction: mean

    # perceptual loss (content and style losses)
    perceptual_opt:
      layer_weights:
        # before relu
        'conv1_2': 0.1
        'conv2_2': 0.1
        'conv3_4': 1
        'conv4_4': 1
        'conv5_4': 1
      vgg_type: vgg19
      use_input_norm: true
      perceptual_weight: !!float 1.0
      style_weight: 0.000001
      range_norm: false
      criterion: l1

    # gan loss
    gan_opt:
      gan_type: vanilla
      real_label_val: 1.0
      fake_label_val: 0.0
      loss_weight: !!float 1e-1
